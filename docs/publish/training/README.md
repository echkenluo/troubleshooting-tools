# eBPF 网络测量工具培训文档

本文档面向一线售后团队，帮助快速掌握网络问题定界和测量工具的使用方法。

---

## 文档结构

| 章节 | 内容 | 建议阅读时间 |
|------|------|-------------|
| [第1章 快速入门](1-快速入门.md) | 两阶段排查方法、定界场景 | 5分钟 |
| [第2章 工具选择指南](2-工具选择指南.md) | **核心章节**：性能开销、完整决策树 | 15分钟 |
| [第3章 核心工具详解](3-核心工具详解.md) | 各类工具的详细使用方法 | 30分钟 |
| [第4章 扩展能力预览](4-扩展能力预览.md) | 工具发布状态、数据路径覆盖 | 5分钟 |
| [第5章 常见问题与输出解读](5-常见问题与输出解读.md) | FAQ、输出解读、调试技巧 | 10分钟 |
| [附录 命令速查表](附录-命令速查表.md) | **可打印**：快速参考 | - |

---

## 快速导航

### 按问题类型

| 问题 | 推荐章节 |
|------|---------|
| 网络丢包（ICMP） | [1.2 场景1](1-快速入门.md#场景1丢包定界icmp)、[2.2.2 ICMP定界](2-工具选择指南.md#222-icmp-快速定界路径推荐) |
| 网络丢包（TCP/UDP） | [2.2.3 协议专用](2-工具选择指南.md#223-协议专用工具路径)、[3.1.2](3-核心工具详解.md#312-tcp_path_tracerpy) |
| 系统网络延迟 | [1.2 场景2](1-快速入门.md#场景2延迟定界--系统网络)、[3.2.1](3-核心工具详解.md#321-system_network_icmp_rttpy) |
| VM 网络延迟 | [1.2 场景3](1-快速入门.md#场景3延迟定界--vm-网络)、[3.2.2](3-核心工具详解.md#322-kernel_icmp_rttpy) |
| OVS 问题 | [3.6 OVS 工具](3-核心工具详解.md#36-ovs-相关工具) |
| 虚拟化网络问题 | [3.8 KVM 虚拟化](3-核心工具详解.md#38-kvm-虚拟化网络工具) |
| TCP 性能问题 | [3.10 TCP 性能](3-核心工具详解.md#310-tcp-性能分析工具dev-分支) |
| 工具无输出 | [5.1 Q1](5-常见问题与输出解读.md#q1-工具无输出) |
| 看不懂输出 | [5.2 输出解读](5-常见问题与输出解读.md#52-输出解读指南) |

### 按使用阶段

| 阶段 | 推荐内容 |
|------|---------|
| 初次使用 | 第1章 → 第2章 |
| 日常使用 | 附录命令速查表 |
| 遇到问题 | 第5章 FAQ |
| 需要深入 | 第3章工具详解 |

---

## 核心方法论

### 两阶段排查

> **阶段一：定界** — 确定问题在内部还是外部
>
> 使用 path_tracer 和 *_icmp_rtt 系列工具，开销低，快速定位问题区段。

> **阶段二：详情** — 深入分析内部问题
>
> 使用 *_latency_summary/details 和 eth_drop 系列工具，提供逐包/逐阶段详细数据。

### 性能开销

> **开销取决于过滤后事件速率，不是原始流量大小。**
>
> 配合严格过滤（延迟阈值、五元组），Details 工具也可以安全运行。
> 详见 [2.1 性能开销模型](2-工具选择指南.md#21-性能开销模型必读)

### 分层策略

> **先 Summary，后 Details！**
>
> 延迟问题先用 Summary 工具识别异常，提取过滤条件后再用 Details 精确定位。

---

## 工具命名说明

| 名称模式 | 含义 |
|---------|------|
| `*_path_tracer.py` | 路径跟踪器，用于定界 |
| `*_icmp_rtt.py` | ICMP RTT 测量 |
| `*_latency_summary.py` | 延迟统计（直方图） |
| `*_latency_details.py` | 延迟详情（逐包） |
| `*_drop*.py` | 丢包检测 |
| `*_performance_metrics.py` | 综合性能指标 |

---

## 版本信息

- 文档版本：2.0
- 适用工具版本：upstream-pr 分支（已发布）+ dev 分支（开发中）
- 最后更新：2025年

---

## 反馈与支持

如有问题或建议，请联系开发团队。
